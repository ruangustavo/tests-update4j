<?xml version="1.0"?>
<!DOCTYPE protocol SYSTEM "application/src/main/resources/protocols-config.dtd">
<protocol name="UPSILON-VOLTRONIC" type="MONO">
    <Command>
        <key>F</key>
        <alias>Caracteristicas</alias><!--  usedby="MONO, TRI"> -->
        <description>Resgata caracteristicas sobre o UPS</description>
        <!-- Pattern: : F<CR> -->
        <Request beanType="ComandoNobreak">
            <param name="Comando" type="char" value="F"/>
        </Request>
        <!-- Pattern: #MMM.M QQQ SS.SS RR.R<CR> -->
        <Response beanType="CaracteristicasBean" validation="false">
            <param name="FaixaTensao" size="4" type="string"/>
            <param name="FaixaCorrente" size="2" type="string"/>
            <param name="TensaoBateria" size="4" type="string"/>
            <param name="Frequencia" size="3" type="string"/>
        </Response>
    </Command>

    <Command>
        <key>F</key>
        <alias>CaracteristicasDefault</alias><!--  usedby="MONO, TRI"> -->
        <description>Resgata caracteristicas padrão sobre o UPS</description>
        <!-- Pattern: : F<CR> -->
        <Request beanType="CaracteristicasBean">
            <param name="FaixaTensao" size="4" type="string" value="0"/>
            <param name="FaixaCorrente" size="2" type="string" value="0"/>
            <param name="TensaoBateria" size="4" type="string" value="0"/>
            <param name="Frequencia" size="3" type="string" value="0"/>
        </Request>
    </Command>

    <Command>
        <key>QMD</key>
        <alias>Informacoes</alias><!--  usedby="MONO, TRI"> -->
        <description>Resgata Informacoes sobre o UPS</description>
        <!-- Pattern: : QMD<CR> -->
        <Request beanType="ComandoNobreak">
            <param name="Comando" type="char" value="Q"/>
            <param name="Param1" type="char" value="M"/>
            <param name="Param2" type="char" value="D"/>
        </Request>
        <!-- Pattern: (TTTTTTTTTTTTTTT WWWWWWW KK P/P MMM NNN RR BB.B <cr>  -->
        <Response beanType="InformacoesVoltronicBean" start="1" validation="false">
            <param name="Modelo" size="16" type="string" calc='"{Modelo}".replaceAll("#", "");'/>
            <param name="OutrosDados" size="25" type="string" ignore="true"/>
            <param name="Versao" size="1" type="string" value=""/>
            <param name="TensaoPadraoBateria" size="4" type="string"/>
        </Response>
    </Command>

    <Command>
        <key>I</key>
        <alias>InformacoesDefault</alias>
        <description>Resgata informações do UPS</description>
        <Request beanType="InformacoesVoltronicBean">
            <param name="Modelo" size="1" type="string" value=""/>
            <param name="Versao" size="1" type="string" value=""/>
        </Request>
    </Command>


    <Command>
        <key>QGS</key>
        <alias>MedidoresEstado</alias><!--  usedby="MONO, TRI"> -->
        <description>Resgata medidores e status do UPS</description>
        <!-- Pattern: : QGS<CR> -->
        <Request beanType="ComandoNobreak">
            <param name="Comando" type="char" value="Q"/>
            <param name="Param1" type="char" value="G"/>
            <param name="Param2" type="char" value="S"/>
            <param name="CaracterInicial" type="char" value="("/>
            <param name="TamanhoResposta" type="int" value="76"/>
        </Request>
        <!-- Pattern: (MMM.M HH.H LLL.L NN.N QQQ.Q DDD KKK.K VVV.V SSS.S XXX.X TTT.T b9b8b7b6b5b4b3b2b1b0<cr> -->
        <Response beanType="MedidorEstadoUpsilonBean" validation="false" start="1">
            <param name="TensaoEntrada" size="6" type="string"/>
            <param name="UltimaTensao" size="5" type="string" ignore="true"/>
            <param name="TensaoSaida" size="6" type="string"/>
            <param name="FrequenciaSaida" size="5" type="string"/>
            <param name="PotenciaSaidaAtual" size="6" type="string" ignore="true"/>
            <param name="PotenciaSaida" size="4" type="string"/>
            <param name="TensaoBarramentoPositivo" size="6" type="string" ignore="true"/>
            <param name="TensaoBarramentoNegativo" size="6" type="string" ignore="true"/>
            <param name="TensaoBateriaPositivo" size="6" type="string" ignore="true"/>
            <param name="TensaoBateriaNegativo" size="6" type="string" ignore="true"/>
            <param name="Temperatura" size="6" type="string"/>
            <param name="Tipo" size="2" type="char"/>
            <param name="BateriaLigada" size="1" type="boolean" ignore="true"/>
            <param name="BateriaBaixa" size="1" type="boolean"/>
            <param name="ByPass" size="1" type="boolean"/>
            <param name="UpsOk" size="1" type="boolean" calc="({UpsOk}*-1)+1"/>
            <param name="EPO" size="1" type="boolean" ignore="true"/>
            <param name="TesteAtivo" size="1" type="boolean" ignore="true"/>
            <param name="ShutdownAtivo" size="1" type="boolean" ignore="true"/>
            <param name="BeepLigado" size="1" type="boolean"/>
        </Response>
    </Command>

    <Command>
        <key>QBV</key>
        <alias>MedidoresEstado</alias><!--  usedby="MONO, TRI"> -->
        <description>Consulta informações sobre a potência bateria</description>
        <!-- Pattern: : QBV<cr> -->
        <Request beanType="ComandoNobreak">
            <param name="Comando" type="char" value="Q"/>
            <param name="Param1" type="char" value="B"/>
            <param name="Param2" type="char" value="V"/>
        </Request>
        <!-- Pattern: (RRR.R NN MM CCC TTT<cr> -->
        <Response beanType="MedidorEstadoUpsilonBean" validation="false" start="13">
            <param name="PorcentagemTensaoBateria" size="4" type="string"/>
        </Response>
    </Command>

    <Command>
        <key>QMOD</key>
        <alias>MedidoresEstado</alias><!--  usedby="VOLTRONIC"> -->
        <description>Consulta informações sobre status do nobreak</description>
        <!-- Pattern: : QBV<cr> -->
        <Request beanType="ComandoNobreak">
            <param name="Comando" type="char" value="Q"/>
            <param name="Param1" type="char" value="M"/>
            <param name="Param2" type="char" value="O"/>
            <param name="Param3" type="char" value="D"/>
        </Request>
        <!-- Pattern: (RRR.R NN MM CCC TTT<cr> -->
        <Response beanType="MedidorEstadoUpsilonBean" validation="false" start="1">
            <param name="Qmod" size="1" type="string"/>
            <param name="Standby" size="1" type="boolean" refs="Qmod" calc="('{Qmod}'!='S')?0:1"/>
            <param name="ByPass" size="1" type="boolean" refs="Qmod" calc="('{Qmod}'!='Y')?0:1"/>
            <param name="Boost" size="1" type="boolean" refs="ByPass" calc="({Boost}*-1)+1"/>
            <param name="BateriaLigada" size="1" type="boolean" refs="Qmod" calc="('{Qmod}'!='B')?0:1"/>
            <param name="TesteAtivo" size="1" type="boolean" refs="Qmod" calc="('{Qmod}'!='T')?0:1"/>
            <param name="ShutdownAtivo" size="1" type="boolean" refs="Qmod" calc="('{Qmod}'!='D')?0:1"/>/>
        </Response>
    </Command>

    <Command> <!-- key="Q" alias="MedidoresEstado"> -->
        <key>QGS</key>
        <alias>MedidoresEstadoDefault</alias><!-- usedby="MONO, TRI"> -->
        <description>Resgata um bean com os valores pré-definidos para os medidores e status do UPS</description>
        <Request beanType="MedidorEstadoBean">
            <param name="UltimaTensao" size="1" type="string" value="0"/>
            <param name="TensaoEntrada" size="1" type="string" value="0"/>
            <param name="TensaoSaida" size="1" type="string" value="0"/>
            <param name="PotenciaSaida" size="1" type="string" value="0"/>
            <param name="FrequenciaSaida" size="1" type="string" value="0"/>
            <param name="PorcentagemTensaoBateria" size="1" type="string" value="0"/>
            <param name="Temperatura" size="1" type="string" value="0"/>
            <param name="BeepLigado" size="1" type="boolean" value="false"/>
            <param name="ShutdownAtivo" size="1" type="boolean" value="false"/>
            <param name="TesteAtivo" size="1" type="boolean" value="false"/>
            <param name="UpsOk" size="1" type="boolean" value="false"/>
            <param name="Boost" size="1" type="boolean" value="false"/>
            <param name="ByPass" size="1" type="boolean" value="false"/>
            <param name="BateriaBaixa" size="1" type="boolean" value="false"/>
            <param name="BateriaLigada" size="1" type="boolean" value="false"/>
            <param name="Tipo" size="2" type="string" value="UPS Line Interative"/>
        </Request>
    </Command>

    <!-- ################################################# Disparos ################################################# -->

    <Command>
        <key>TL</key>
        <alias>TesteBateriaBaixa</alias><!--  usedby="MONO, TRI"> -->
        <description>Executa teste de bateria até que a mesma se torne baixa</description>
        <!-- Pattern: : TL<CR> -->
        <Request beanType="ComandoNobreakSR"> <!-- beanType="ComandoNobreakSR" -->
            <param name="Comando" type="char" value="T"/>
            <param name="Parametro" type="char" value="L"/>
        </Request>
        <!--
            <Response>
                This command has no response
            </Response>
        -->
    </Command>

    <Command>
        <key>T</key>
        <alias>TestePorSegundos</alias><!--  usedby="MONO, TRI"> -->
        <description>Executa teste de bateria por n segundos</description>
        <!-- Pattern: : T<CR> -->
        <Request beanType="ComandoNobreakSR">
            <param name="Comando" type="char" value="T"/>
        </Request>
        <!--
            <Response>
                This command has no response
            </Response>
        -->
    </Command>

    <Command>
        <key>Q</key>
        <alias>MudaBeep</alias>
        <description>Muda o beep</description>
        <Request beanType="ComandoNobreakSR">
            <!-- Pattern: Q<CR> -->
            <param name="Comando" type="char" value="Q"/>
        </Request>
        <!--
            <Response>
                This command has no response
            </Response>
        -->
    </Command>

    <Command>
        <key>SOFF</key>
        <alias>Shutdown</alias>
        <description>Shutdown UPS</description>
        <Request beanType="ComandoNobreakSR">
            <!-- Pattern: S<n><CR> -->
            <param name="Comando" type="char" value="S"/>
            <param name="Parametro" type="char" value="O"/>
            <param name="Parametro" type="char" value="F"/>
            <param name="Parametro" type="char" value="F"/>
        </Request>
        <!--
            <Response>
                This command has no response
            </Response>
        -->
    </Command>

    <Command>
        <key>S</key>
        <alias>ShutdownPorSegundos</alias>
        <description>Shutdown por n segundos</description>
        <Request beanType="ComandoNobreakSR">
            <!-- Pattern: S<n><CR> -->
            <param name="Comando" type="char" value="S"/>
        </Request>
        <!--
            <Response>
                This command has no response
            </Response>
        -->
    </Command>

    <Command>
        <key>SR</key>
        <alias>ShutdownRestore</alias>
        <description>Shutdown e restore</description>
        <Request beanType="ComandoNobreakSR">
            <!-- Pattern: : S<n>R<m><CR> -->
            <param name="Comando" type="char" value="S"/>
        </Request>
        <!--
            <Response>
                This command has no response
            </Response>
        -->
    </Command>

    <Command>
        <key>C</key>
        <alias>CancelarShutdownRestore</alias>
        <description>Cancela o Shutdown e restore</description>
        <Request beanType="ComandoNobreakSR">
            <!-- Pattern: C<CR> -->
            <param name="Comando" type="char" value="C"/>
        </Request>
        <!--
            <Response>
                This command has no response
            </Response>
        -->
    </Command>

    <Command>
        <key>CT</key>
        <alias>CancelarTeste</alias>
        <description>Cancelamento de Teste</description>
        <Request beanType="ComandoNobreakSR">
            <!-- Pattern: CT<CR> -->
            <param name="Comando" type="char" value="C"/>
            <param name="Parametro" type="char" value="T"/>
        </Request>
        <!--
            <Response>
                This command has no response
            </Response>
        -->
    </Command>
</protocol>